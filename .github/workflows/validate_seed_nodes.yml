name: Validate Seed Nodes

on:
  push:
    branches: [ "master", "main" ]
    paths:
      - 'seed-nodes.json'
      - 'utils/seed_nodes_schema.json'
      - 'utils/validate_seed_nodes.py'
  pull_request:
    branches: [ "master", "main" ]
    paths:
      - 'seed-nodes.json'
      - 'utils/seed_nodes_schema.json'
      - 'utils/validate_seed_nodes.py'
  workflow_dispatch:

jobs:
  validate:
    runs-on: ubuntu-22.04
    name: Validate Seed Nodes Configuration
    
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.8'

      - name: Install dependencies
        run: |
          python3 -m pip install --upgrade pip
          pip3 install -r utils/requirements.txt

      - name: Check seed nodes file exists
        run: |
          if [ ! -f "seed-nodes.json" ]; then
            echo "‚ùå seed-nodes.json file not found!"
            exit 1
          fi
          echo "‚úì seed-nodes.json file exists"

      - name: Check schema file exists
        run: |
          if [ ! -f "utils/seed_nodes_schema.json" ]; then
            echo "‚ùå utils/seed_nodes_schema.json file not found!"
            exit 1
          fi
          echo "‚úì utils/seed_nodes_schema.json file exists"
         
      - name: Validate seed nodes JSON schema
        run: |
          echo "Validating seed-nodes.json against schema..."
          python3 utils/validate_seed_nodes.py

      - name: Validation Summary
        run: |
            echo "üéâ All seed nodes validation checks passed!"
            echo "‚úì Schema validation successful"
            echo "‚úì All seed nodes are properly formatted"
            echo "‚úì Host addresses are valid (domains/IPs)"
            echo "‚úì Contact information is properly structured" 